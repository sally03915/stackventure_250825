
44
팀별 포지션별 FW, MF, DF, GK 포지션의 인원수와 팀별 전체 인원수를
구하는 SQL을 작성할 때 결과가 다른 것은? (보기 1은 SQL Server
환경이고, 보기 2,3,4는 ORACLE 환경이다)
SELECT TEAM_ID,
ISNULL(SUM(CASE WHEN POSITION = 'FW' THEN 1 END), 0) FW,
ISNULL(SUM(CASE WHEN POSITION = 'MF' THEN 1 END), 0) MF,
ISNULL(SUM(CASE WHEN POSITION = 'DF' THEN 1 END), 0) DF ISNULL(SUM(CASE WHEN POSITION = 'GK' THEN 1 END), 0) GK,
COUNT(*) SUM
FROM PLAYER
GROUP BY TEAM_ID;
SELECT TEAM_ID,
NVL(SUM(CASE POSITION WHEN 'FW
THEN 1
END),0) FW,
NVL(SUM(CASE POSITION WHEN 'MF'
THEN 1
END),0) MF,
NVL(SUM(CASE POSITION WHEN 'DF'
THEN 1
END),0) DF,
NVL(SUM(CASE POSITION WHEN 'GK
THEN 1
END),0) GK,
COUNT(*) SUM
FROM PLAYER
GROUP BY TEAM_ID;
3 SELECT TEAM_ID,
NVL(SUM(CASE WHEN POSITION = 'FW
THEN 1 END), 0) FW,
NVL(SUM(CASE WHEN POSITION = 'MF'
THEN 1
END), 0) MF,
NVL(SUM(CASE WHEN POSITION = 'DF'
THEN 1
END), 0) DF,
NVL(SUM(CASE WHEN POSITION = 'GK
THEN 1 END), 0) GK,
COUNT(*) SUM
FROM PLAYER
GROUP BY TEAM_ID;
4 SELECT TEAM_ID,
NVL(SUM(CASE POSITION WHEN 'FW THEN 1 ELSE 1 END),0) FW,
NVL(SUM(CASE POSITION WHEN 'MF NVL(SUM(CASE POSITION WHEN 'DF' NVL/SUMICASE POSITION WHEN 'GK
THEN 1 ELSE 1 END),0) MF, THEN 1 ELSE 1 END),0) DF, THEN 1 ELSE 1 END),0) GK,
COUNT(*) SUM FROM PLAYER
GROUP BY TEAM ID;