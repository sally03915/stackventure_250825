
94. 3
위의 Self Join은 Equi Join이 아닌 Range Join이므로 A의 레코드는 B의 레코드 수 만큼 증가하게 된다. (A*B) 그러므로 위의 3번의 경우 A는 B의 레코드 개수와 동일하게 되므로 SUM(매출금액)을 하면 3,000이 된다. 이런 식으로 A Alias의 모든 레코드 개수를 Scan하면 누적 값을 출력하게 된다.
해설: WHERE 절의 단일행 서브쿼리인 (SELECT D FROM DEPT WHERE E=Y)에 의해서 DEPT 테이블의 D 컬럼 값이 x인 행이 선택되고, D= (SELECTD FROM DEPT WHERE E=Y) 조건에 의해 EMP 테이블의 (A=1, B=a), (A=2, B=a) 인 2건이 출력된다. 출력된 결과가 모두 UNIQUE하기 때문에 DISTINCT 연산자는 결과 건수에 영향을 주지 않는다.
95. 2
해설: 다) 서브쿼리의 결과가 복수 행 결과를 반환하는 경우에는 IN, ALL, ANY 등의 복수 행 비교 연산자와 사용하여야 한다.
마) 다중 컬럼 서브쿼리는 서브쿼리의 결과로 여러 개의 컬럼이 반환되어 메인 쿼리의 조건과 비교되는 데, SQL Server에서는 현재 지원하지 않는 기능이다.
96. 3
해설: '현재 부양하는 가족들이 없는 사원들의 이름을 구하라'를 구현하는 방법은 가족 테이블에 부양사이 없는 사원 이름을 사원 테이블에서 추출 하면 되고, SQL 문장으로 NOT EXISTS, NOT IN, LEFT OUTER JOIN을 사용하여 구현 할 수 있다.
1. NOT EXISTS
SELECT 이름
FROM 사원
WHERE NOT EXISTS (SELECT * FROM 가족 WHERE 사번= 부양사번)
2. NOT IN
SELECT 이름
FROM 사원
WHERE 사번 NOT IN (SELECT 부양사번 FROM 가족)
3. LEFT OUTER JOIN
SELECT 이름
FROM 사원 LEFT OUTER JOIN 가족 ON (사번= 부양사번) WHERE 부양사번 IS NULL
SQL 자격검정 실전문제 | 243