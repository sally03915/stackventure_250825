
111. 2
해설 : GROUPPING SETS 함수는 표시된 인수들에 대한 개별 집계를 구하는 기능을 하며, 위의 SQL은
(상품ID, 월)별 집계 데이터를 출력한다. 각 보기별 SQL은 아래와 같다.
1 GROUPING SETS에 괄호를 사용하지 않아 월별과 상품ID별로 각각 집계되었다.
SELECT 상품ID, 월, SUM(매출액) AS 매출액
FROM 월별매출
WHERE 월 BETWEEN '2014.10' AND '2014.12
GROUP BY GROUPING SETS(월, 상품ID);
3 GROUPING SETS에 월별, 상품ID별과 전체가 각각 집계되었다.
SELECT 상품ID, 월, SUM(매출액) AS 매출액
ORD FROM
월별매출
WHERE 월 BETWEEN '2014.10' AND '2014.12
GROUP BY GROUPING SETS(월, 상품ID, ());
GROUPING SETS에 (월, 상품ID)별, 월별로 집계되었다.
SELECT 상품ID, 월, SUM(매출액) AS 매출액
FROM 월별매출
WHERE 월 BETWEEN 2014.10' AND '2014.12
GROUP BY GROUPING SETS ((월, 상품ID), 월);
112, 3
100
해설: 윈도우 함수는 결과에 대한 함수처리이기 때문에 결과 건수는 줄지 않는다.
113.1
해설: 위의 SQL은 고객별 매출액과 매출 순위를 구하되 동일 순위일 경우 중간 순위를 비워둔 데이터를 122
114.4
추출한다. 순위를 구하는 함수로는 RANK, DENSE_RANK, ROW_NUMBER 함수가 있다. RANK WINDOW FUNCTION은 동일 값에 대해서는 동일 순위를 부여하고 중간 순위는 비워 두지만, DENSE_RANK 함수는 동일 순위를 부여하되 중간 순위를 비우지 않는다. ROW_NUMBER 함수는 동일 값에 대해서도 유일한 순위를 부여한다.
해설: 게임상품별로 고객 목록을 추출하기 위해서는 OVER절에 "PARTITION BY 게임상품ID"를 적용하여 게임상품별 활동점수로 순위가 추출될 수 있도록 하여야 한다.
RANK WINDOW 함수는 OVER절의 ORDER BY에 대한 결과에 따라 동일한 값을 동일한 등수로 처리 함과 동시에 중간 순위를 비우는 반면, DENSE_RANK WINDOW 함수는 중간 순위를 비우지 않는다.
SQL 자격검정 실전문제 | 249