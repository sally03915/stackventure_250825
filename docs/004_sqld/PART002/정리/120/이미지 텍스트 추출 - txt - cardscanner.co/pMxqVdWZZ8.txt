
110.4
해설: 집계 그룹 함수에는 ROLLUP, CUBE, GROUPING SETS 함수가 있다.
문제의 결과 데이터는 (자재번호별) SUB TOTAL과 (자재번호, 발주처별) SUB TOTAL을 출력하고 있다. GROUPING SETS 함수를 사용하여 입력된 인수들에 대한 개별 집계를 구할 수 있으며, CUBE 함수의 경우는 나열된 모든 인수의 결합 가능한 집계가 출력 된다. 그러므로 위의 문제에서는 GROUP BY GROUPING SETS(자재번호, (발주처ID, 발주일자))가 되어야 한다. 1, 2, 3의 보기별 결과는
아래와 같다.
2
1
자재번호 발주ID 발주일자
발주수량
자재번호 발주체D
발주일자 발주수량
1
20140102
100
1
1
1
20140102
100
1
1
20140103
200
1
1
20140103
200
1
1
발주일자전체
300
1
발주처전체 발주일자전체
300
1
발주처전체
20140102
100
2
1
20140102
200
1
발주처전체
20140103
200
2
2
20140102
100
1
발주처전체
발주일자전체
300
2
발주처전체 발주일자전체
300
2
1
20140102
200
3
1
20140103
100
2
1
발주일자전체
200
2
2
20140102
100
3
2
20140103
200
2
2
발주일자전체
100
3
발주처전체 발주일자전체
300
2
발주처전체
20140102
300
자재전체
1
20140102
300
2
발주처전체 발주일자전체
300
자재전체
1
20140103
300
3
1
20140103
100
자재전체
2
20140102
100
3
1
발주일자전체
100
자재전체
2
20140103
200
3
2
20140103
200
자재전체 발주처전체 발주일자전체
900
3
2
발주일자전체
200
3
발주처전체
20140103
300
3
3
발주처전체 발주일자전체
300
자재번호 발주체D
발주일자
발주수량
자재전체
1
20140102
300
1 발주처 전체 발주일자전
300
자재전체
1
20140103
300
2
발주처전체 발주일자 전체
300
자재전체
1
발주일자전체
600
3
발주처전체 발주일자전체
자재전체
2
300
20140102
100
자재전체
2
자재전체
1
발주일자전체
20140103
600
200
자재전체 2
자재전체
발주일자전체
2
발주일자전체
300
300
자재전체 발주처전체
20140102
자재전체 발주처전체
400
20140102
400
자재전체 발주처전체 20140103
자재전체 발주처전체 20140103
500
자재전체 발주처전체 발주일자전체
500
900
248 | SQL 자격검정 실전문제