
115. 3
해설: ROW_NUMBER 함수는 ORDER BY절에 의해 정렬된 데이터에 동일 값이 존재하더라도 유일한 순위를
116. 3
부여하는 함수로서 데이터 그룹 내에 유일한 순위를 추출할 때 사용할 수 있는 함수이다. 문제의 SQL은 추천경로별(PARTITION BY 추천경로)로 추천점수가 가장 높은(ORDER BY 추천점수
DESC) 데이터를 한건씩만 출력하지만,
1은 전체 데이터를 그대로 출력하였으며
2는 전체에서 추천점수가 가장 높은 데이터 한건만을 출력하였고
4은 추천경로별로 추천점수가 가장 낮은 데이터를 각 한건씩 출력하였다.
해설: GROUP BY 절의 집합을 원본으로 하는 데이터를 WINDOW FUNCTION과 함께 사용한다면 GROUP BY 절과 함께 WINDOW FUNCTION을 사용한다고 하더라도 오류가 발생하지 않으며, 유사개수 컬럼 은 상품분류코드로 GROUPING된 집합을 원본집합으로 하여 상품분류코드별 평균상품가격을 서로 비교하여 현재 읽혀진 상품분류코드의 평균가격 대비 -10000~ +10000사이에 존재하는 상품분류코 드의 개수를 구한 것이다.
117.
해설: 안쪽 IN-LINE VIEW에 의해 아래와 같이 사원ID와 부서별 최고연봉이 결과로 생성되며
사원ID
최고연봉
001
3000
002
3000
003
4500
004
4500
005
4500
006
4500
007
4500
이를 다시 사원 테이블과 사원ID= 사원ID AND 최고연봉 = 연봉으로 JOIN을 하게 되면 부서별 최고연봉의 사원이 출력된다. 아래의 SQL로도 동일한 결과를 얻을 수 있다.
SELECT 사원ID, 사원명, 부서ID, 연봉
FROM (SELECT 사원ID, 사원명, 부서ID, 연봉
, MAX(연봉) OVER(PARTITION BY 부서ID) AS 최고연봉
FROM 사원)
WHERE 연봉 최고연봉
=
200
400